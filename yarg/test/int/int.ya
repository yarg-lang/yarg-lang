var x = int(10);
x = x + int(-10);
print x; // expect: 0

x = x + int(10) + int(10);
print x; // expect: 20

var i8 = int8(-123);
var u8 = uint8(200);
var i16 = int16(-20000);
var u16 = uint16(50000);
var i32 = int32(-2000000000);
var u32 = uint32(0d3000000000);
var i64 = int64(-int(5000000000000000000));
var u64 = uint64(0d10000000000000000000);
print i8; // expect: -123
print u8; // expect: 200
print i16; // expect: -20000
print u16; // expect: 50000
print i32; // expect: -2000000000
print u32; // expect: 3000000000
print i64; // expect: -5000000000000000000
print u64; // expect: 10000000000000000000

var a = int(i8);
var b = int(u8);
var s = int(i16);
var r = int(u16);
var t = int(i32);
var d = int(u32);
var q = int(i64);
var p = int(u64);
print a; // expect: -123
print b; // expect: 200
print s; // expect: -20000
print r; // expect: 50000
print t; // expect: -2000000000
print d; // expect: 3000000000
print q; // expect: -5000000000000000000
print p; // expect: 10000000000000000000

var t2 = a + b + s + r + t + d + q + p;
print t2; // expect: 5000000001000030077

var int tenToTheFour = 10000;

a = -0;
print a; // expect: 0

a = int(123);
b = int(4567);
print a < b; // expect: true

a = int(9223372036854775807);
b = int(9223372036854775806);
print a <= b; // expect: false

a = 922337203685477580701;
b = 922337203685477580700;
print a < b; // expect: false

a = 922337203685477580701;
b = 922337203685477580700;
print a == b; // expect: false

a = int(0);
b = int(-1);
print a > b; // expect: true

b = -b;
print a >= b; // expect: false

a = int(-2);
b = int(-1);
print a <= b; // expect: true

b = int(2);
print a < b; // expect: true

a = int(123);
b = int(4567);
r = a + b;
t = int(123+4567);
print r == t; // expect: true

/*
    int_set_i(1230000001, &a);
    int_set_i(45675555555, &b);
    int_invariant(&a);
    int_invariant(&b);
    int_add(&a, &b, &r); //buggy
    int_invariant(&r);
    int_set_i(1230000001+45675555555, &t);
    int_invariant(&t);
    assert(int_is(&r, &t) == INT_EQ);

    int_set_i(9223372036854775807L, &a);
    int_set_i(9223372036854775806ll, &b);
    int_invariant(&a);
    int_invariant(&b);
    int_add(&a, &b, &r);
    int_invariant(&r);
    int_set_t(&r, &a);
    int_invariant(&a);
    int_set_i(3, &b);
    int_invariant(&b);
    int_add(&a, &b, &r);
    int_invariant(&r);

    int_set_i(4567, &a);
    int_set_i(123, &b);
    int_invariant(&a);
    int_invariant(&b);
    int_sub(&a, &b, &r);
    int_invariant(&r);
    int_set_i(4567-123, &t);
    int_invariant(&t);
    assert(int_is(&r, &t) == INT_EQ);

    int_set_i(1230000001, &a);
    int_set_i(45675555555, &b);
    int_invariant(&a);
    int_invariant(&b);
    int_sub(&a, &b, &r);
    int_invariant(&r);
    int_set_i(45675555555-1230000001, &t);
    int_invariant(&t);
    int_set_i(-1, &a);
    int_set_t(&t, &b);
    int_invariant(&a);
    int_invariant(&b);
    int_mul(&a, &b, &t);
    int_invariant(&t);
    assert(int_is(&r, &t) == INT_EQ);

    int_set_i(1, &a);
    int_set_i(2147483649, &b);
    int_invariant(&a);
    int_invariant(&b);
    int_mul(&a, &b, &r);
    int_invariant(&r);
    assert(int_is(&r, &b) == INT_EQ);

    int_set_i(4567, &a);
    int_set_i(123, &b);
    int_invariant(&a);
    int_invariant(&b);
    int_mul(&a, &b, &r);
    int_invariant(&r);
    int_set_i(4567*123, &t);
    int_invariant(&t);
    assert(int_is(&r, &t) == INT_EQ);

    int_set_i(-4567, &a);
    int_set_i(-123, &b);
    int_invariant(&a);
    int_invariant(&b);
    int_mul(&a, &b, &r);
    int_invariant(&r);
    int_set_i(4567*123, &t);
    int_invariant(&t);
    assert(int_is(&r, &t) == INT_EQ);

    int_set_i(-4567, &a);
    int_set_i(123, &b);
    int_invariant(&a);
    int_invariant(&b);
    int_mul(&a, &b, &r);
    int_invariant(&r);
    int_set_i(-4567*123, &t);
    int_invariant(&t);
    assert(int_is(&r, &t) == INT_EQ);

    int_set_i(1230000001, &a);
    int_set_i(45675, &b);
    int_invariant(&a);
    int_invariant(&b);
    int_mul(&a, &b, &r);
    int_invariant(&r);
    int_set_i(45675*1230000001ll, &t);
    int_invariant(&t);
    assert(int_is(&r, &t) == INT_EQ);
    assert(strcmp(int_to_s(&r, ss, sizeof ss / sizeof ss[0]), "56180250045675") == 0);
    assert(int_to_i64(&r) == 56180250045675);

    int_set_i(10000u, &d);
    int_div(&t, &d, &q, &r);
    int_invariant(&q);
    int_invariant(&r);
    int_set_i(5618025004, &t);
    assert(int_is(&q, &t) == INT_EQ);
    int_set_i(5675, &t);
    assert(int_is(&r, &t) == INT_EQ);

    int_div(&q, &d, &q, &r);
    int_invariant(&q);
    int_invariant(&r);
    int_set_i(561802, &t);
    assert(int_is(&q, &t) == INT_EQ);
    int_set_i(5004, &t);
    assert(int_is(&r, &t) == INT_EQ);

    int_div(&q, &d, &q, &r);
    int_invariant(&q);
    int_invariant(&r);
    int_set_i(56, &t);
    assert(int_is(&q, &t) == INT_EQ);
    int_set_i(1802, &t);
    assert(int_is(&r, &t) == INT_EQ);

    int_div(&q, &d, &q, &r);
    int_invariant(&q);
    int_invariant(&r);
    int_set_i(0, &t);
    assert(int_is(&q, &t) == INT_EQ);
    int_set_i(56, &t);
    assert(int_is(&r, &t) == INT_EQ);

    int_set_s("-12345", &a);
    int_set_i(-12345, &b);
    int_invariant(&a);
    int_invariant(&b);
    assert(int_is(&a, &b) == INT_EQ);

    int_set_i(13421772800000, &a);
    int_set_i(13421772800000, &b);
    int_invariant(&a);
    int_invariant(&b);
    int_div(&a, &b, &q, 0);
    int_invariant(&q);
    int_set_i(13421772800000/13421772800000, &t);
    int_invariant(&t);
    assert(int_is(&q, &t) == INT_EQ);

    int_set_i(13421772800700, &a);
    int_set_i(444, &b);
    int_invariant(&a);
    int_invariant(&b);
    int_div(&a, &b, &q, 0);
    int_invariant(&q);
    int_set_i(13421772800700/444, &t);
    int_invariant(&t);
    assert(int_is(&q, &t) == INT_EQ);

    int64_t tm[][2] =
    {
        {7473558006549, 1234134},
        {74986764527274600, 123},
        {933866438576, 9876543},
        {1234134, 7473558006549},
        {123, 74986764527274600},
        {9876543, 933866438576}
    };

    for (int x = 0; x < sizeof tm / sizeof tm[0]; x++)
    {
        int_set_i(tm[x][0], &a);
        int_set_i(tm[x][1], &b);
        int_invariant(&a);
        int_invariant(&b);
        int_mul(&a, &b, &p);
        int_invariant(&p);
        int_set_i(tm[x][0] * tm[x][1], &t);
        int_invariant(&t);
        assert(int_is(&p, &t) == INT_EQ);
    }

    char const *bb = "45004569476097716405600188052489096276589659783372385398756134755718969568599212452839780406252029736959022214045678577312955372997557808011166351368242024169330770738287024721942327258131593587116073102711494427349137261153163351227207";
    int_set_s(bb, &a);
    int_print(&a);printf("\n%s\n", bb);
    int_for_bc(&a);printf("\n");

    int outit=0;
    while (!int_is_zero(&a))
    {
        if (outit) {int_for_bc(&a);printf("\n");}
        int_div(&a, &tenToTheFour, &a, &r);
        if (outit) {int_for_bc(&a);printf("\n");int_for_bc(&r);printf("\n");outit--;}
        if (int_to_u32(&r) == 6933)
        {
            outit=3;
        }
    }

    char const *tss[][3] =
    {
        {"45004569476097716405600188052489096276589659783372385398756134755718969568599212452839780406252029736959022214045678577320970782103350621657798638622201854375249828618559078165391725554391637336051126938411312935632157993634139676471535", "8015409105792813646632287253959830205919057880272053443449398296260043748935053835699818508283020732480976325244328", "45004569476097716405600188052489096276589659783372385398756134755718969568599212452839780406252029736959022214045678577312955372997557808011166351368242024169330770738287024721942327258131593587116073102711494427349137261153163351227207"}
    };

    for (int x = 0; x < sizeof tss / sizeof tss[0]; x++)
    {
        int_set_s(tss[x][0], &a);
        int_set_s(tss[x][1], &b);
        int_set_s(tss[x][2], &t);
        int_invariant(&a);
        int_invariant(&b);
        int_invariant(&t);
        int_print(&a);printf(" - ");int_print(&b);printf(" => ");int_print(&t);printf("\n");
        int_for_bc(&t);printf("\n");
        int_sub(&a, &b, &d);
        int_invariant(&d);
        int_print(&a);printf(" - ");int_print(&b);printf(" => ");int_print(&d);printf("\n");
        int_for_bc(&d);printf("\n");
        assert(int_is(&d, &t) == INT_EQ);
    }

    div: ;
    char const *tds[][4] =
    {// todo check tds[0]
        {"86563698400295818556941199448342856196291390874257029273792164197338062186852288654487642865217811935325618416908915876918033088986025954151860537725611169266995543550767296630441222794629126373296710055138561939273380431459084392932980372126152312002135410572748911223141469923397490440838165", "-18070117593565567760862671033472963723720349409289083511961936073838222132616574596573447005412193114047731785144138437416182746256138625965817112866449101053048990151277922361862768377405760670987464162", "-4790433595801254714867564177737572902819347095069069988266970457550288026377822578316716665", "10164136718382858196019698312755863418683370176918249611820182655092817691253129467912534954339906708648920291884680103762877562724608016668599591528984883066544947276159939115847509871050635948245178435"},
        {"45004569476097716405600188052489096276589659783372385398756134755718969568599212452839780406252029736959022214045678577312955372997557808011166351368242", "281474976649780", "159888349620839703309792504026546654755626214020039863340514619510330396486743913688737005770575136765815764191961104637097362438018055441", "213649870915262"},
        {"45004569476097716405600188052489096276589659783372385398756134755718969568599212452839780406252029736959022214045678577312955372997557808011166351368242", "10000", "4500456947609771640560018805248909627658965978337238539875613475571896956859921245283978040625202973695902221404567857731295537299755780801116635136", "8242"}
    };

    for (int x = 0; x < sizeof tds / sizeof tds[0]; x++)
    {
        int_set_s(tds[x][0], &a);
        int_set_s(tds[x][1], &b);
        int_set_s(tds[x][2], &t);
        int_set_s(tds[x][3], &t2);
        //        printf("%s - ", tds[x][0]);int_for_bc(&a);printf("\n");
        //        printf("%s - ", tds[x][1]);int_for_bc(&b);printf("\n");
        //        printf("%s - ", tds[x][2]);int_for_bc(&t);printf("\n");
        //        printf("%s - ", tds[x][3]);int_for_bc(&t2);printf("\n");
        int_invariant(&a);
        int_invariant(&b);
        int_invariant(&t);
        int_invariant(&t2);
        int_div(&a, &b, &q, &r);
        int_invariant(&d);
        int_invariant(&r);

        printf("%s\n%s\n", tds[x][0], tds[x][1]);int_for_bc(&q);printf("\n");int_for_bc(&r);printf("\n");

        //        int_for_bc(&q);printf("%s\n", int_is(&q, &t) == INT_EQ ? "÷✔️" : "÷⨯");
        assert(int_is(&q, &t) == INT_EQ);
        //        int_for_bc(&r);printf("%s\n", int_is(&q, &t) == INT_EQ ? "%✔️" : "%⨯");
        assert(int_is(&r, &t2) == INT_EQ);
    }
    //    goto rand;
    char const *tms[][3] =
    {
        {"3351951982485649274893506249551461531869841455148098344430890360930441007518386744200468574541725856922507964546621512713438470702986642486608412251521023", "3351951982485649274893506249551461531869841455148098344430890360930441007518386744200468574541725856922507964546621512713438470702986642486608412251521023", "11235582092889474423308157442431404585112356118389416079589380072358292237843810195794279832650471001320007117491962084853674360550901038905802964414967126069706528367755543042756389622154817142782907388308623998771662556764388893318631168471652618870995561901857550396971275994213576295767236553777010966529"},
        {"2397347246804399775846299341967274735921924813569660373241507470851337453571810991011870651746218077498232562138857178167039275006720515490364277003123459405004422981033297552634257771878766246736362189341419332733400905032674753650288808962155716002977274996173255530038506604174013456449782", "74986764527274600", "179769313486231590772930519078902473361797697894230657273430081157732675805500963132708477322407536021120113879871393357658789768814416622492847430639474124377767893424865485276302219601246094119453082952085005768838150682342462881473913110540827237163350510684586298239947245938479716304835356329624224137200"},
        {"145664339112472057955562782549465838686720970246529677712007027727728654915512386120719854831329123110715784412285370435997055237773545354469488265163648456632560073237481088177055505805079589509285930824436411093801929678902341951096001820337846001457986337532704145773430799198854999785141124326551431", "1234134", "179769313486231590772930519078902473361797697894230657273430081157732675805500963132708477322407536021120113879871393357658789768814416622492847430639474124377767893424865485276302219601246094119453082952085005768838150682342462881473913110540827237163350510684586298239947245938479716304835356329624223745754"},
        {"1461539134034403177015695277064247750908924373123826481897805537867745331752040350672426644897622244074147267316027588273648697307434281483681686427963204263233885312397280368100018045538586131052464089041341510315757322620670429930682220410901034448482524477110457709267863788117721270771019157151416456400", "123", "179769313486231590772930519078902473361797697894230657273430081157732675805500963132708477322407536021120113879871393357658789768814416622492847430639474124377767893424865485276302219601246094119453082952085005768838150682342462881473913110540827237163350510684586298239947245938479716304835356329624224137200"},
        {"74986764527274600", "2397347246804399775846299341967274735921924813569660373241507470851337453571810991011870651746218077498232562138857178167039275006720515490364277003123459405004422981033297552634257771878766246736362189341419332733400905032674753650288808962155716002977274996173255530038506604174013456449782", "179769313486231590772930519078902473361797697894230657273430081157732675805500963132708477322407536021120113879871393357658789768814416622492847430639474124377767893424865485276302219601246094119453082952085005768838150682342462881473913110540827237163350510684586298239947245938479716304835356329624224137200"},
        {"1234134", "145664339112472057955562782549465838686720970246529677712007027727728654915512386120719854831329123110715784412285370435997055237773545354469488265163648456632560073237481088177055505805079589509285930824436411093801929678902341951096001820337846001457986337532704145773430799198854999785141124326551431", "179769313486231590772930519078902473361797697894230657273430081157732675805500963132708477322407536021120113879871393357658789768814416622492847430639474124377767893424865485276302219601246094119453082952085005768838150682342462881473913110540827237163350510684586298239947245938479716304835356329624223745754"},
        {"123", "1461539134034403177015695277064247750908924373123826481897805537867745331752040350672426644897622244074147267316027588273648697307434281483681686427963204263233885312397280368100018045538586131052464089041341510315757322620670429930682220410901034448482524477110457709267863788117721270771019157151416456400", "179769313486231590772930519078902473361797697894230657273430081157732675805500963132708477322407536021120113879871393357658789768814416622492847430639474124377767893424865485276302219601246094119453082952085005768838150682342462881473913110540827237163350510684586298239947245938479716304835356329624224137200"},
        {"13407807929942597099574024998205846127479365820592393377723561443721764030073546976801874298166903427690031858186486050853753882811946569946433649006084095", "13407807929942597099574024998205846127479365820592393377723561443721764030073546976801874298166903427690031858186486050853753882811946569946433649006084095", "179769313486231590772930519078902473361797697894230657273430081157732675805500963132708477322407536021120113879871393357658789768814416622492847430639474097562152033539671286128252223189553839160721441767298250321715263238814402734379959506792230903356495130620869925267845538430714092411695463462326211969025"},
        {"13407807929942597099574024998205846127479365820592393377723561443721764030073546976801874298166903427690031858186486050853753882811946569946433649006084094", "13407807929942597099574024998205846127479365820592393377723561443721764030073546976801874298166903427690031858186486050853753882811946569946433649006084095", "179769313486231590772930519078902473361797697894230657273430081157732675805500963132708477322407536021120113879871393357658789768814416622492847430639474084154344103597074186554227224983707711681355621174904872598153819517050372660832982704917932736453067440589011738781794684676831280465125517028677205884930"}
    };

    for (int x = 0; x < sizeof tms / sizeof tms[0]; x++)
    {
        int_set_s(tms[x][0], &a);
        int_set_s(tms[x][1], &b);
        int_set_s(tms[x][2], &t);
        int_invariant(&a);
        int_invariant(&b);
        int_invariant(&t);
        int_print(&a);printf(" * ");int_print(&b);printf(" - ");int_print(&t);printf("\n");
        int_mul(&a, &b, &p);
        int_invariant(&p);
        int_print(&a);printf(" * ");int_print(&b);printf(" - ");int_print(&p);printf("\n");
        assert(int_is(&p, &t) == INT_EQ);
    }

    int64_t td[][2] =
    {
        {13421772800000, 13421772800000},
        {13421772800700, 444},
        {-13421772800700, 444},
        {13421772800700, -444},
        {-13421772800700, -444},
        {9223372036854775807, 9223372036854775807},
        {9223372036854775807, 9223372036854775806},
        {9223372036854775806, 9223372036854775807},
        {9223372036854775807, 1},
        {9223372036854775806, 1},
        {9223372036854775807, 11},
        {9223372036854775806, 16},
        {9223372036854775806, 21},
        {9223372036854775806, 65536},
        {9223372036854775806, 4294967296}
    };

    for (int x = 0; x < sizeof td / sizeof td[0]; x++)
    {
        int_set_i(td[x][0], &a);
        int_set_i(td[x][1], &b);
        int_invariant(&a);
        int_invariant(&b);
        int_div(&a, &b, &q, &r);
        int_invariant(&q);
        int_invariant(&r);
        int_set_i(td[x][0] / td[x][1], &t);
        int_invariant(&t);
        assert(int_is(&q, &t) == INT_EQ);
        int_set_i(td[x][0] % td[x][1], &t);
        int_invariant(&t);
        assert(int_is(&r, &t) == INT_EQ);
    }

rand: // pipe the output from here into `bc -lLS 0`
    for (int x = 0; x < 100000; x++)
    {
        printf("%d\n", x);

        int_make_random(&a);int_invariant(&a);
        int_make_random(&b);int_invariant(&b);

        int_add(&a, &b, &s);
        if (!s.overflow_)
        {
            int_invariant(&s);
            int_for_bc(&a);printf(" + ");int_for_bc(&b);printf(" - ");int_for_bc(&s);printf("\n");
        }
        else
        {
            //            printf("%d\n", x);
            s.overflow_ = false;
        }

        int_sub(&a, &b, &d);
        if (!d.overflow_)
        {
            int_invariant(&d);
            int_for_bc(&a);printf(" - ");int_for_bc(&b);printf(" - ");int_for_bc(&d);printf("\n");
        }
        else
        {
            //            printf("%d\n", x);
            d.overflow_ = false;
        }

        int_mul(&a, &b, &p);
        if (!p.overflow_)
        {
            int_invariant(&p);
            int_print(&a);printf(" * ");int_print(&b); printf(" - ");int_print(&p);printf("\n");
        }
        else
        {
            //            printf("%d\n", x);
            p.overflow_ = false;
        }

        int_div(&a, &b, &q, &r);int_invariant(&q);int_invariant(&r);
        int_for_bc(&a);printf(" / ");int_for_bc(&b);printf(" - ");int_for_bc(&q);printf("\n");
        int_for_bc(&a);printf(" %% ");int_for_bc(&b);printf(" - ");int_for_bc(&r);printf("\n");
    }
}
*/
